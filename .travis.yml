language: node_js
node_js:
- 10

sudo: required

os:
- osx

addons:
  chrome: stable

before_script:
- export DISPLAY=:99.0

install:
- npm install

jobs:
  include:
  - stage: test + build
    if: branch != master
    script:
    - npm run test
    - ng lint
    - npm run build:prod
  - stage: build + publish
    if: branch = master
    os:
    - osx
    script:
    - npm run publish:mac
  - stage: build + deploy win
    if: branch = master
    os:
    - windows
    script: npm run publish:windows
